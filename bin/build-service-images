#!/bin/bash

set -e

SELF=$(basename $0)

function usage
{
  echo "Usage: $SELF [-p|--parallel -h] [service_name ...]"
  echo "Builds the images for all listed service names that have matching sub-directories in the 'services' directory."
  echo "Builds all images if none are listed."
  echo ""
  echo "-p - run builds in parallel"
  echo "-h - print this message"
}

function wait_for_pids {
  pids=$1
  for pid in "${pids[@]}"; do
    wait "$pid"
  done
}

PARALLEL=0

while [[ $# -gt 0 ]]
do
key="$1"

case $key in
  -p|--parallel)
  PARALLEL=1
  shift
  ;;
  -h|--help)
  usage
  exit 0
  ;;
  *)
  break
  ;;
esac
done

# build all the image in the 'services' directory
function build_all {
  pnpm build-all
}

build_all



